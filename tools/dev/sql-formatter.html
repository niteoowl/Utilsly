<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL 포맷터 - Utilsly</title>
    <meta name="description" content="복잡한 SQL 쿼리를 읽기 쉽게 정렬해주는 도구입니다.">
    <link rel="stylesheet" href="../../css/style.css">
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="avatar">U</div>
                    <span class="username">Utilsly</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <!-- Sidebar content generated by js/common.js -->
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <div class="breadcrumbs">
                    <span class="breadcrumb-item">Utilsly</span>
                    <span class="separator">/</span>
                    <span class="breadcrumb-item">개발</span>
                    <span class="separator">/</span>
                    <span class="breadcrumb-item current-page">SQL 포맷터</span>
                </div>
            </header>

            <div class="content-area">
                <div class="page-header">
                    <div class="header-icon-wrapper">
                        <span class="material-symbols-rounded">database</span>
                    </div>
                    <h1>SQL 포맷터</h1>
                    <p class="description">복잡한 SQL 쿼리문을 읽기 쉽게 정렬하고 포맷팅합니다.</p>
                </div>

                <div class="tool-container">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; height: 500px;">
                        <div style="display: flex; flex-direction: column;">
                            <label style="margin-bottom: 8px; font-weight: 600;">입력 SQL</label>
                            <textarea id="input" style="flex: 1; font-family: var(--font-mono); font-size: 14px;"
                                placeholder="SELECT * FROM users WHERE id = 1"></textarea>
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="margin-bottom: 8px; font-weight: 600;">포맷팅 결과</label>
                            <textarea id="output" readonly
                                style="flex: 1; font-family: var(--font-mono); font-size: 14px; background: #f8f9fa;"></textarea>
                        </div>
                    </div>

                    <div style="margin-top: 24px; display: flex; gap: 12px;">
                        <button class="btn btn-primary" onclick="formatSQL()">포맷팅</button>
                        <button class="btn" onclick="copyResult()">복사</button>
                        <button class="btn" onclick="document.getElementById('input').value = ''">지우기</button>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="../../js/common.js"></script>
    <script>
        function formatSQL() {
            let sql = document.getElementById('input').value;

            // Very basic SQL formatting logic (Regex based)
            // In a real production app, we would use a library like sql-formatter
            const keywords = ["SELECT", "FROM", "WHERE", "AND", "OR", "ORDER BY", "GROUP BY", "HAVING", "LIMIT", "INSERT INTO", "VALUES", "UPDATE", "SET", "DELETE", "JOIN", "LEFT JOIN", "RIGHT JOIN", "INNER JOIN", "OUTER JOIN", "ON", "AS", "CASE", "WHEN", "THEN", "ELSE", "END"];

            // Normalize spaces
            sql = sql.replace(/\s+/g, ' ');

            // Add newlines before keywords
            keywords.forEach(kw => {
                const regex = new RegExp(`\\b${kw}\\b`, 'gi');
                sql = sql.replace(regex, (match) => `\n${match.toUpperCase()}`);
            });

            // Indentation (Simple)
            sql = sql.replace(/\n/g, '\n  ').trim();

            // Fix first line indentation
            document.getElementById('output').value = sql;
        }

        function copyResult() {
            const output = document.getElementById('output');
            output.select();
            document.execCommand('copy');
            alert('복사되었습니다!');
        }
    </script>
</body>

</html>