<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>코드 미니파이어 - Utilsly</title>
    <meta name="description" content="HTML, CSS, JS 코드를 압축하여 용량을 줄이세요.">
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        .minifier-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            height: 500px;
        }

        .editor-wrapper {
            display: flex;
            flex-direction: column;
            gap: 8px;
            height: 100%;
        }

        textarea {
            flex: 1;
            padding: 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            resize: none;
            font-family: var(--font-mono);
            font-size: 14px;
            line-height: 1.5;
        }

        .controls {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            align-items: center;
            background: var(--bg-sidebar);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .radio-group {
            display: flex;
            gap: 16px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="avatar">U</div>
                </div>
            </div>
            <nav class="sidebar-nav">
                <!-- Sidebar content generated by js/common.js -->
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <div class="breadcrumbs">
                    <span class="breadcrumb-item">코드 미니파이어</span>
                </div>
            </header>

            <div class="content-area">
                <div class="page-header">
                    <div class="header-icon-wrapper">
                        <span class="material-symbols-rounded">compress</span>
                    </div>
                    <h1>코드 미니파이어</h1>
                    <p class="description">HTML, CSS, JavaScript 코드를 압축하여 파일 크기를 최적화하세요.</p>
                </div>

                <div class="controls">
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="lang" value="html" checked> HTML
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="lang" value="css"> CSS
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="lang" value="js"> JavaScript
                        </label>
                    </div>
                    <div style="flex: 1;"></div>
                    <button class="btn btn-primary" onclick="minifyCode()">압축하기 (Minify)</button>
                    <button class="btn" onclick="copyResult()">복사</button>
                </div>

                <div class="minifier-container">
                    <div class="editor-wrapper">
                        <label style="font-weight: 600;">원본 코드</label>
                        <textarea id="inputCode" placeholder="여기에 코드를 붙여넣으세요..."></textarea>
                    </div>
                    <div class="editor-wrapper">
                        <label style="font-weight: 600;">압축된 코드</label>
                        <textarea id="outputCode" readonly placeholder="결과가 여기에 표시됩니다."></textarea>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="../../js/common.js"></script>
    <script>
        function minifyCode() {
            const input = document.getElementById('inputCode').value;
            const lang = document.querySelector('input[name="lang"]:checked').value;
            let output = '';

            if (!input.trim()) {
                alert('코드를 입력해주세요.');
                return;
            }

            try {
                switch (lang) {
                    case 'html':
                        output = input
                            .replace(/\s+/g, ' ') // Collapse whitespace
                            .replace(/>\s+</g, '><') // Remove whitespace between tags
                            .replace(/<!--[\s\S]*?-->/g, ''); // Remove comments
                        break;
                    case 'css':
                        output = input
                            .replace(/\/\*[\s\S]*?\*\//g, '') // Remove comments
                            .replace(/\s+/g, ' ') // Collapse whitespace
                            .replace(/\s*([{}:;,])\s*/g, '$1') // Remove space around separators
                            .replace(/;\}/g, '}'); // Remove last semicolon
                        break;
                    case 'js':
                        // Basic JS Minification (Regex based - NOT perfect but safe for simple scripts)
                        output = input
                            .replace(/\/\/.*$/gm, '') // Remove single line comments
                            .replace(/\/\*[\s\S]*?\*\//g, '') // Remove multi line comments
                            .replace(/\s+/g, ' ') // Collapse whitespace
                            .replace(/\s*([=+\-*/{}();,])\s*/g, '$1'); // Remove space around operators
                        break;
                }
                document.getElementById('outputCode').value = output.trim();
            } catch (e) {
                alert('압축 중 오류가 발생했습니다.');
                console.error(e);
            }
        }

        function copyResult() {
            const output = document.getElementById('outputCode');
            output.select();
            document.execCommand('copy');
            alert('복사되었습니다!');
        }
    </script>
</body>

</html>